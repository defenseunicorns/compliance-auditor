domain:
  type: kubernetes
  kubernetes-spec:
    resources:
    {{ range .variables.resources }}
    - name: {{ .name }}
      resource-rule:
        group: {{ .group }}
        version: {{ .version }}
        resource: {{ .resource }}
        namespaces: {{ .namespaces }}
    {{ end }}
provider: 
  type: opa
  opa-spec:
    rego: |
      package validate

      import future.keywords.every

      validate {
        every pod in input.{{ .variables.target }} {
          podLabel := pod.metadata.labels.foo
          podLabel == "bar"
        }
      }