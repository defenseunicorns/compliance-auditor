metadata:
  name: Validate pods with label foo=bar
  uuid: 1234
domain:
  type: kubernetes
  kubernetes-spec:
    resources:
      - name: podsvt
        resource-rule:
          name: demo-pod
          version: v1
          resource: pods
          namespaces: [validation-test]
      - name: notFound
        resource-rule:
          version: v1
          resource: notaresource
          namespaces: [validation-test]
provider:
  type: opa
  opa-spec:
    rego: |
      package validate

      import future.keywords.every
      default msg = "test 2"
      validate {
        podLabel := input.podsvt.metadata.labels.foo
        podLabel == "bar"
      }
    output:
      validation: validate.validate
      observations:
        - validate.msg