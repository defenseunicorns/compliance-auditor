component-definition:
  back-matter:
    resources:
      - description: |-
          domain:
            type: kubernetes
            kubernetes-spec:
              resources:
              - name: podsvt
                resource-rule:
                  group:
                  version: v1
                  resource: test-pod-label
                  namespaces: [validation-test]
          provider:
            type: opa
            opa-spec:
              rego: |
                package validate

                import future.keywords.every

                validate {
                  every pod in input.podsvt {
                    podLabel := pod.metadata.labels.foo
                    podLabel == "bar"
                  }
                }
        rlinks:
          - href: lula.dev
        uuid: a7377430-2328-4dc4-a9e2-b3f31dc1dff9
      - description: |
          domain:
            kubernetes-spec:
              create-resources: null
              resources:
              - description: ""
                name: podvt
                resource-rule:
                  group: ""
                  name: '{{ .const.resources.name }}'
                  namespaces:
                  - '{{ .const.resources.namespace }}'
                  resource: pods
                  version: v1
            type: kubernetes
          lula-version: ""
          metadata:
            name: Lula Validation
            uuid: 8f0fe0ce-14dc-468c-986a-145a3238ed10
          provider:
            opa-spec:
              rego: |
                package validate
                import rego.v1

                # Default values
                default validate := false
                default msg := "Not evaluated"

                # Validation result
                validate if {
                  { "one", "two", "three" } == { {{ .const.resources.exemptions | concatToRegoList }} }
                  "{{ .var.some_env_var }}" == "my-env-var"
                  "{{ .var.some_lula_secret }}" == "********"
                }
                msg = validate.msg

                value_of_my_secret := {{ .var.some_lula_secret }}
            type: opa
        title: Lula Validation
        uuid: 8f0fe0ce-14dc-468c-986a-145a3238ed10
      - description: |
          domain:
            kubernetes-spec:
              create-resources: null
              resources:
              - description: ""
                name: podsvt
                resource-rule:
                  group: ""
                  name: ""
                  namespaces:
                  - validation-test
                  resource: pods
                  version: v1
            type: kubernetes
          lula-version: '>=v0.2.0'
          metadata:
            name: Validate pods with label foo=bar
            uuid: 969402b8-7a90-411a-806b-f200c36d60da
          provider:
            opa-spec:
              rego: |
                package validate

                import future.keywords.every

                validate {
                  every pod in input.podsvt {
                    podLabel := pod.metadata.labels.foo
                    podLabel == "bar"
                  }
                }
            type: opa
        title: Validate pods with label foo=bar
        uuid: 969402b8-7a90-411a-806b-f200c36d60da
  components:
    - control-implementations:
        - description: Validate generic security requirements
          implemented-requirements:
            - control-id: ID-1
              description: This control validates that the demo-pod pod in the validation-test namespace contains the required pod label foo=bar in order to establish compliance.
              links:
                - href: '#a7377430-2328-4dc4-a9e2-b3f31dc1dff9'
                  rel: lula
                  text: local template validation
                - href: '#8f0fe0ce-14dc-468c-986a-145a3238ed10'
                  rel: lula
                  text: local path template validation
                - href: '#969402b8-7a90-411a-806b-f200c36d60da'
                  rel: lula
                  text: validation with spaces that need to be cleaned
                - href: '#db9a9007-dd7d-486a-9f03-18e5b30c80c3'
                  rel: lula
                  text: validation with template from remote
              uuid: 42C2FFDC-5F05-44DF-A67F-EEC8660AEFFD
          source: https://raw.githubusercontent.com/usnistgov/oscal-content/master/nist.gov/SP800-53/rev5/json/NIST_SP-800-53_rev5_catalog.json
          uuid: A584FEDC-8CEA-4B0C-9F07-85C2C4AE751A
      description: |
        Lula - the Compliance Validator
      purpose: Validate compliance controls
      responsible-roles:
        - party-uuids:
            - C18F4A9F-A402-415B-8D13-B51739D689FF
          role-id: provider
      title: lula
      type: software
      uuid: A9D5204C-7E5B-4C43-BD49-34DF759B9F04
  metadata:
    last-modified: XXX
    oscal-version: 1.1.2
    parties:
      - links:
          - href: https://github.com/defenseunicorns/lula
            rel: website
        name: Lula Development
        type: organization
        uuid: C18F4A9F-A402-415B-8D13-B51739D689FF
    title: Lula Demo
    version: "20220913"
  uuid: E6A291A4-2BC8-43A0-B4B2-FD67CAAE1F8F
