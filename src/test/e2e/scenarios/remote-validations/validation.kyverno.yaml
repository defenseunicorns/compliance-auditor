title: Lula Validation
target:
  provider: kyverno
  domain: kubernetes
  payload:
    resources:
      - name: podsvt # Identifier for use in the rego below
        resource-rule: # Mandatory, resource selection criteria, at least one resource rule is required
          group: # empty or "" for core group
          version: v1 # Version of resource
          resource: pods # Resource type
          namespaces: [validation-test] # Namespaces to validate the above resources in. Empty or "" for all namespaces or non-namespaced resources
    kyverno:
      apiVersion: json.kyverno.io/v1alpha1
      kind: ValidatingPolicy
      metadata:
        name: labels
      spec:
        rules:
          - name: foo-label-exists
            assert:
              all:
                - check:
                    ~.podsvt:
                      metadata:
                        labels:
                          foo: bar
