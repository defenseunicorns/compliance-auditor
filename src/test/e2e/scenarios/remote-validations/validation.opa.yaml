---
title: Validate pods with label foo=bar
lula-version: ">= v0.1.0"
target:
  provider: opa
  domain: kubernetes
  payload:
    resources:
      - name: podsvt # Identifier for use in the rego below
        resource-rule: # Mandatory, resource selection criteria, at least one resource rule is required
          group: # empty or "" for core group
          version: v1 # Version of resource
          resource: pods # Resource type
          namespaces: [validation-test] # Namespaces to validate the above resources in. Empty or "" for all namespaces or non-namespaced resources
    rego: |
      package validate

      import future.keywords.every

      validate {
        every pod in input.podsvt {
          podLabel := pod.metadata.labels.foo
          podLabel == "bar"
        }
      }
