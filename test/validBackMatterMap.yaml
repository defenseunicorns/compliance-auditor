88AB3470-B96B-4D7C-BC36-02BF9563C46C:
  title: Lula Validation
  lula-version: ""
  target:
    provider: opa
    domain: kubernetes
    payload:
      resources:
        - name: jsoncm
          description: ""
          resource-rule:
            name: configmap-json
            group: ""
            version: v1
            resource: configmaps
            namespaces:
              - validation-test
            field:
              jsonpath: .data.person.json
              type: yaml
              base64: false
        - name: yamlcm
          description: ""
          resource-rule:
            name: configmap-yaml
            group: ""
            version: v1
            resource: configmaps
            namespaces:
              - validation-test
            field:
              jsonpath: .data.app-config.yaml
              type: yaml
              base64: false
        - name: secret
          description: ""
          resource-rule:
            name: example-secret
            group: ""
            version: v1
            resource: secrets
            namespaces:
              - validation-test
            field:
              jsonpath: .data.auth
              type: yaml
              base64: true
        - name: pod
          description: ""
          resource-rule:
            name: example-pod
            group: ""
            version: v1
            resource: pods
            namespaces:
              - validation-test
            field:
              jsonpath: .metadata.annotations.annotation.io/simple
              type: json
              base64: false
      wait:
        condition: ""
        jsonpath: ""
        kind: ""
        namespace: ""
        timeout: ""
      rego: |-
        package validate

        import future.keywords.every

        validate {
          input.jsoncm.name == "bob"
          input.yamlcm.logging.level == "INFO"
          input.secret.username == "username"
          "item1" in input.pod.items
        }
      output:
        validation: ""
  evaluated: false
  result:
    uuid: ""
    control-id: ""
    description: ""
    passing: 0
    failing: 0
    state: ""
